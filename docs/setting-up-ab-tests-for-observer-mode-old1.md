---
title: "Implement A/B tests in Observer mode"
description: "Learn how to seamlessly integrate A/B tests in Adapty's Observer mode by mapping transactions to corresponding paywalls in your mobile app code. Explore efficient strategy for implementing A/B testing in Observer mode for optimized user experiences"
metadataTitle: "Observer Mode A/B Testing Implementation: Mapping Transactions to paywalls in Adapty"
---

If you already have your own purchase infrastructure and aren't prepared to switch to Adapty's system, you can explore the [Adapty Observer mode](observer-vs-full-mode).

## Enable A/B tests in Observer mode

In Observer mode, Adapty SDK cannot determine the source of purchases as you make them in your own infrastructure. Therefore, if you intend to use A/B tests in Observer mode, you need to associate the transaction coming from your app store with the corresponding paywall in your mobile app code.

### Preliminary configuration

1. Set up initial integration of Adapty [with the Google Play](initial-android) and [with the App Store](initial_ios). 
2. Install and configure Adapty SDK. Make sure to set the `observerMode` parameter to `true`. Refer to our framework-specific instructions [for iOS](sdk-installation-ios#configure-adapty-sdk), [for Android](adapty-sdk-installation-android#configure-adapty-sdk), [for Flutter](sdk-installation-flutter#configure-adapty-sdks-for-ios), [for React Native](sdk-installation-reactnative#configure-adapty-sdks), and [for Unity](sdk-installation-unity#initiate-adapty-unity-plugin-on-ios).
3. [Create products](create-product) in the Adapty Dashboard.
4. [Configure paywalls and assign products to them](create-paywall) using the remote config in the Adapty Dashboard.
5. [Set up A/B tests and allocate paywalls to them](ab-tests) in the Adapty Dashboard.
6. [Create placements and assign A/B tests to them](create-placement) in the Adapty Dashboard.
7. [Display paywalls designed with remote config](display-remote-config-paywalls) in your mobile app. 
8. Implement making purchases on the paywall buy-button click.

### Mapping used paywalls to purchase transactions

After the preliminary configuration is done, you need to map the transaction generated by Apple with the corresponding paywall in your mobile app code using the `variationId` parameter as shown in the example below. Only if you accurately associate them, you will be able to see the correct metrics in the Adapty Dashboard.

```swift title="title="let variationId = paywall.variationId""

// There are two overloads: for StoreKit 1 and StoreKit 2
Adapty.setVariationId(variationId, forPurchasedTransaction: transaction) { error in
    if error == nil {
        // successful binding
    }    
}
```
```kotlin title="title="Adapty.setVariationId(transactionId, variationId) { error ->""
    if (error == null) {
        // success
    }
}
```
```java title="title="Adapty.setVariationId(transactionId, variationId, error -> {""
    if (error == null) {
        // success
    }
});
```
```javascript title="title="Flutter""
final transactionId = transaction.transactionIdentifier
final variationId = paywall.variationId

try {
  await Adapty().setVariationId('transaction_id', variationId);
} on AdaptyError catch (adaptyError) {
  // handle the error
} catch (e) {
}
```
```typescript title="title="const variationId = paywall.variationId;""

try {
	await adapty.setVariationId('transaction_id', variationId);
} catch (error) {
	// handle the `AdaptyError`
}
```
```csharp title="title="Unity""
Adapty.SetVariationForTransaction("<variationId>", "<transactionId>", (error) => { 
    if(error != null) {
        // handle the error
        return;
    }

    // successful binding
});
```

Request parameters:

| Parameter | Presence | Description |
|---------|--------|-----------|
| **variationId** | required | The string identifier of the variation. You can get it using `variationId` property  of the [`AdaptyPaywall`](sdk-models#adaptypaywall)  object. |
| **transaction** | required | <p>For iOS, StoreKit1: an [`SKPaymentTransaction`](https://developer.apple.com/documentation/storekit/skpaymenttransaction)  object.</p><p>For iOS, StoreKit 2: [Transaction](https://developer.apple.com/documentation/storekit/transaction)  object.</p><p>For Android: String identifier (`purchase.getOrderId()`) of the purchase, where the purchase is an instance of the billing library [Purchase](https://developer.android.com/reference/com/android/billingclient/api/Purchase) class.</p> |


For accurate analytics, ensure the transaction is associated with the paywall within 3 hours of its creation.

